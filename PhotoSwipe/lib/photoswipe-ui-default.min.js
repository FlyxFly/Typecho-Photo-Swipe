(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.PhotoSwipeUI_Default=t()}})(this,function(){"use strict";var e=function(o,s){var n=this;var e=false,i=true,t,a,r,l,u,c,f,p=true,d,m,h,w,v,g,b,_,C={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(e,t){if(!e.title){t.children[0].innerHTML="";return false}t.children[0].innerHTML=e.title;return true},closeEl:true,captionEl:true,fullscreenEl:true,zoomEl:true,shareEl:true,counterEl:true,arrowEl:true,preloaderEl:true,tapToClose:false,tapToToggleControls:true,clickToCloseNonZoomable:true,shareButtons:[{id:"facebook",label:"分享到Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"分享到Twitter",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"分享到Pinterest",url:"http://www.pinterest.com/pin/create/button/"+"?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"下载图片",url:"{{raw_image_url}}",download:true}],getImageURLForShare:function(){return o.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return o.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},T,I;var E=function(e){if(T){return true}e=e||window.event;if(_.timeToIdle&&_.mouseUsed&&!m){A()}var t=e.target||e.srcElement,n,o=t.getAttribute("class")||"",i;for(var r=0;r<N.length;r++){n=N[r];if(n.onTap&&o.indexOf("pswp__"+n.name)>-1){n.onTap();i=true}}if(i){if(e.stopPropagation){e.stopPropagation()}T=true;var l=s.features.isOldAndroid?600:30;I=setTimeout(function(){T=false},l)}},F=function(){return!o.likelyTouchDevice||_.mouseUsed||screen.width>_.fitControlsWidth},x=function(e,t,n){s[(n?"add":"remove")+"Class"](e,"pswp__"+t)},S=function(){var e=_.getNumItemsFn()===1;if(e!==b){x(a,"ui--one-slide",e);b=e}},k=function(){x(f,"share-modal--hidden",p)},K=function(){p=!p;if(!p){k();setTimeout(function(){if(!p){s.addClass(f,"pswp__share-modal--fade-in")}},30)}else{s.removeClass(f,"pswp__share-modal--fade-in");setTimeout(function(){if(p){k()}},300)}if(!p){O()}return false},L=function(e){e=e||window.event;var t=e.target||e.srcElement;o.shout("shareLinkClick",e,t);if(!t.href){return false}if(t.hasAttribute("download")){return true}window.open(t.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,"+"location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100));if(!p){K()}return false},O=function(){var e="",t,n,o,i,r;for(var l=0;l<_.shareButtons.length;l++){t=_.shareButtons[l];o=_.getImageURLForShare(t);i=_.getPageURLForShare(t);r=_.getTextForShare(t);n=t.url.replace("{{url}}",encodeURIComponent(i)).replace("{{image_url}}",encodeURIComponent(o)).replace("{{raw_image_url}}",o).replace("{{text}}",encodeURIComponent(r));e+='<a href="'+n+'" target="_blank" '+'class="pswp__share--'+t.id+'"'+(t.download?"download":"")+">"+t.label+"</a>";if(_.parseShareButtonOut){e=_.parseShareButtonOut(t,e)}}f.children[0].innerHTML=e;f.children[0].onclick=L},R=function(e){for(var t=0;t<_.closeElClasses.length;t++){if(s.hasClass(e,"pswp__"+_.closeElClasses[t])){return true}}},y,z,M=0,A=function(){clearTimeout(z);M=0;if(m){n.setIdle(false)}},D=function(e){e=e?e:window.event;var t=e.relatedTarget||e.toElement;if(!t||t.nodeName==="HTML"){clearTimeout(z);z=setTimeout(function(){n.setIdle(true)},_.timeToIdleOutside)}},P=function(){if(_.fullscreenEl&&!s.features.isOldAndroid){if(!t){t=n.getFullscreenAPI()}if(t){s.bind(document,t.eventK,n.updateFullscreen);n.updateFullscreen();s.addClass(o.template,"pswp--supports-fs")}else{s.removeClass(o.template,"pswp--supports-fs")}}},U=function(){if(_.preloaderEl){Z(true);h("beforeChange",function(){clearTimeout(g);g=setTimeout(function(){if(o.currItem&&o.currItem.loading){if(!o.allowProgressiveImg()||o.currItem.img&&!o.currItem.img.naturalWidth){Z(false)}}else{Z(true)}},_.loadingIndicatorDelay)});h("imageLoadComplete",function(e,t){if(o.currItem===t){Z(true)}})}},Z=function(e){if(v!==e){x(w,"preloader--active",!e);v=e}},q=function(e){var t=e.vGap;if(F()){var n=_.barsSize;if(_.captionEl&&n.bottom==="auto"){if(!l){l=s.createEl("pswp__caption pswp__caption--fake");l.appendChild(s.createEl("pswp__caption__center"));a.insertBefore(l,r);s.addClass(a,"pswp__ui--fit")}if(_.addCaptionHTMLFn(e,l,true)){var o=l.clientHeight;t.bottom=parseInt(o,10)||44}else{t.bottom=n.top}}else{t.bottom=n.bottom==="auto"?0:n.bottom}t.top=n.top}else{t.top=t.bottom=0}},B=function(){if(_.timeToIdle){h("mouseUsed",function(){s.bind(document,"mousemove",A);s.bind(document,"mouseout",D);y=setInterval(function(){M++;if(M===2){n.setIdle(true)}},_.timeToIdle/2)})}},H=function(){h("onVerticalDrag",function(e){if(i&&e<.95){n.hideControls()}else if(!i&&e>=.95){n.showControls()}});var t;h("onPinchClose",function(e){if(i&&e<.9){n.hideControls();t=true}else if(t&&!i&&e>.9){n.showControls()}});h("zoomGestureEnded",function(){t=false;if(t&&!i){n.showControls()}})};var N=[{name:"caption",option:"captionEl",onInit:function(e){r=e}},{name:"share-modal",option:"shareEl",onInit:function(e){f=e},onTap:function(){K()}},{name:"button--share",option:"shareEl",onInit:function(e){c=e},onTap:function(){K()}},{name:"button--zoom",option:"zoomEl",onTap:o.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(e){u=e}},{name:"button--close",option:"closeEl",onTap:o.close},{name:"button--arrow--left",option:"arrowEl",onTap:o.prev},{name:"button--arrow--right",option:"arrowEl",onTap:o.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){if(t.isFullscreen()){t.exit()}else{t.enter()}}},{name:"preloader",option:"preloaderEl",onInit:function(e){w=e}}];var W=function(){var i,r,l;var e=function(e){if(!e){return}var t=e.length;for(var n=0;n<t;n++){i=e[n];r=i.className;for(var o=0;o<N.length;o++){l=N[o];if(r.indexOf("pswp__"+l.name)>-1){if(_[l.option]){s.removeClass(i,"pswp__element--disabled");if(l.onInit){l.onInit(i)}}else{s.addClass(i,"pswp__element--disabled")}}}}};e(a.children);var t=s.getChildByClass(a,"pswp__top-bar");if(t){e(t.children)}};n.init=function(){s.extend(o.options,C,true);_=o.options;a=s.getChildByClass(o.scrollWrap,"pswp__ui");h=o.listen;H();h("beforeChange",n.update);h("doubleTap",function(e){var t=o.currItem.initialZoomLevel;if(o.getZoomLevel()!==t){o.zoomTo(t,e,333)}else{o.zoomTo(_.getDoubleTapZoom(false,o.currItem),e,333)}});h("preventDragEvent",function(e,t,n){var o=e.target||e.srcElement;if(o&&o.getAttribute("class")&&e.type.indexOf("mouse")>-1&&(o.getAttribute("class").indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(o.tagName))){n.prevent=false}});h("bindEvents",function(){s.bind(a,"pswpTap click",E);s.bind(o.scrollWrap,"pswpTap",n.onGlobalTap);if(!o.likelyTouchDevice){s.bind(o.scrollWrap,"mouseover",n.onMouseOver)}});h("unbindEvents",function(){if(!p){K()}if(y){clearInterval(y)}s.unbind(document,"mouseout",D);s.unbind(document,"mousemove",A);s.unbind(a,"pswpTap click",E);s.unbind(o.scrollWrap,"pswpTap",n.onGlobalTap);s.unbind(o.scrollWrap,"mouseover",n.onMouseOver);if(t){s.unbind(document,t.eventK,n.updateFullscreen);if(t.isFullscreen()){_.hideAnimationDuration=0;t.exit()}t=null}});h("destroy",function(){if(_.captionEl){if(l){a.removeChild(l)}s.removeClass(r,"pswp__caption--empty")}if(f){f.children[0].onclick=null}s.removeClass(a,"pswp__ui--over-close");s.addClass(a,"pswp__ui--hidden");n.setIdle(false)});if(!_.showAnimationDuration){s.removeClass(a,"pswp__ui--hidden")}h("initialZoomIn",function(){if(_.showAnimationDuration){s.removeClass(a,"pswp__ui--hidden")}});h("initialZoomOut",function(){s.addClass(a,"pswp__ui--hidden")});h("parseVerticalMargin",q);W();if(_.shareEl&&c&&f){p=true}S();B();P();U()};n.setIdle=function(e){m=e;x(a,"ui--idle",e)};n.update=function(){if(i&&o.currItem){n.updateIndexIndicator();if(_.captionEl){_.addCaptionHTMLFn(o.currItem,r);x(r,"caption--empty",!o.currItem.title)}e=true}else{e=false}if(!p){K()}S()};n.updateFullscreen=function(e){if(e){setTimeout(function(){o.setScrollOffset(0,s.getScrollY())},50)}s[(t.isFullscreen()?"add":"remove")+"Class"](o.template,"pswp--fs")};n.updateIndexIndicator=function(){if(_.counterEl){u.innerHTML=o.getCurrentIndex()+1+_.indexIndicatorSep+_.getNumItemsFn()}};n.onGlobalTap=function(e){e=e||window.event;var t=e.target||e.srcElement;if(T){return}if(e.detail&&e.detail.pointerType==="mouse"){if(R(t)){o.close();return}if(s.hasClass(t,"pswp__img")){if(o.getZoomLevel()===1&&o.getZoomLevel()<=o.currItem.fitRatio){if(_.clickToCloseNonZoomable){o.close()}}else{o.toggleDesktopZoom(e.detail.releasePoint)}}}else{if(_.tapToToggleControls){if(i){n.hideControls()}else{n.showControls()}}if(_.tapToClose&&(s.hasClass(t,"pswp__img")||R(t))){o.close();return}}};n.onMouseOver=function(e){e=e||window.event;var t=e.target||e.srcElement;x(a,"ui--over-close",R(t))};n.hideControls=function(){s.addClass(a,"pswp__ui--hidden");i=false};n.showControls=function(){i=true;if(!e){n.update()}s.removeClass(a,"pswp__ui--hidden")};n.supportsFullscreen=function(){var e=document;return!!(e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen)};n.getFullscreenAPI=function(){var e=document.documentElement,t,n="fullscreenchange";if(e.requestFullscreen){t={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:n}}else if(e.mozRequestFullScreen){t={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+n}}else if(e.webkitRequestFullscreen){t={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+n}}else if(e.msRequestFullscreen){t={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}}if(t){t.enter=function(){d=_.closeOnScroll;_.closeOnScroll=false;if(this.enterK==="webkitRequestFullscreen"){o.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)}else{return o.template[this.enterK]()}};t.exit=function(){_.closeOnScroll=d;return document[this.exitK]()};t.isFullscreen=function(){return document[this.elementK]}}return t}};return e});